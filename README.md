# Docker を使った Rails の環境構築手順

https://github.com/docker/awesome-compose/tree/master/official-documentation-samples/rails

# 当初の仕様

- クリエイターが ebook をアップロードする。
- ebook の著者は複数人に設定できる。
- カスタマーは、買い切り購入と月間ライセンス購入の 2 通りの方法で ebook をダウンロードすることができる。
- カスタマーはカートに ebook を追加した上で、買い切り購入することができる。
- 買い切り購入した ebook は、期限なくいつまでもダウンロードすることができる。
- カスタマーは、月間ライセンスを購入することができる。ライセンスを購入すると、そのライセンスのプランによって定められた冊数の ebook を、期限内であればダウンロードすることができる。
- ライセンスを用いて ebook をダウンロードする場合、再ダウンロード可能なのはライセンスが有効な期間だけである。
- 買い切り購入及びライセンス購入の際の決済手段は、カード決済と paypal 決済の 2 種類から選べる。
- 買い切り購入をした履歴は、後から参照できるようになっている。そこには、いつ何の ebook をいくらで購入したのかのデータが存在している。
- ライセンスの購入履歴も、後から参照できるようになっている。
- 月間ライセンスは自動更新をすることもでき、自動更新をした場合のみ、使い切らなかった冊数分のダウンロードを、自動更新後の月に持ち越すことができる。そのライセンスで付与されるダウンロードの権利を持ち越せるのは 1 回のみ。
- ゆくゆくは、年間プランや従量課金プランを追加していったり、エンタープライズ機能を追加していけるといいかも。

# ざっくり、ディレクトリとその考え方のイメージ

- ドメイン領域
  - app/models
    - エンティティ、ドメインイベントに該当するもの
  - app/values
    - 値オブジェクトに該当するもの
  - app/services
    - ドメインサービスに該当するものを書く
  - app/lib
    - 汎用サブドメイン的な領域に含まれるそうな機能を提供するモジュールはここに置く。
- ユースケース領域
  - app/controllers
    - 単一の model を呼び出しあれこれするようなシンプルなアプリケーションサービス的なものは、そのままここに書く
  - app/application_services
    - アプリケーションサービスに該当するもののうち、controller に書くには違和感があるものを書く。
      - 例えば、複数の model を参照してあれこれするが、そこにドメインロジック的な蓋然性は存在しないのでドメインサービスには当たらない・・・みたいな時。
  - app/controllers/concern
    - 多分使わない。
    - concern は、自分の設計思想のもとではどのような役割としても位置付けることが難しいように感じる。
    - ここに置くと切り出せるし controller から参照できて便利だから・・・とかそういう practical な理由だけで使うということはしない。
- その他、適宜 ↑ よりも小さい粒度で切り出せそうな時は切り出していくことになりそう。forms とか errors とか。
